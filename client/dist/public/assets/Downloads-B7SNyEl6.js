import{c as B,a as E,b as J,r as N,d as V,j as e,B as a,M as w,L as G,P as v}from"./index-CQ1CQ49d.js";import{C as l,c as d}from"./card-DpWYKoFa.js";import{I as H}from"./input-qs3aDXbm.js";import{B as b}from"./badge-BdddEGjl.js";import{S as P,a as Q,b as F,c as K,d as y}from"./select-BYC0_WxO.js";import{T as R,a as U,b as M,c as q}from"./tabs-3Ol6Aavg.js";import{D as h}from"./download-BPDawjom.js";import{S as W,C as X}from"./search-CDKHGpBb.js";import{T as S}from"./trash-2-CJoP-qv4.js";import"./index-C5XG4sJr.js";import"./index-DVzphYQM.js";import"./check-C9F5kHoc.js";import"./index-XX2ipCzA.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=B("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=B("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]),L=()=>{try{const r=localStorage.getItem("downloadedSongs");return r?JSON.parse(r):[]}catch(r){return console.error("Error reading downloads from localStorage:",r),[]}},_=[{id:"song-1",title:"أهواك",artistId:"artist-1",downloadDate:new Date("2024-01-15"),fileSize:4.2,quality:"320kbps",status:"completed"},{id:"song-2",title:"ليلة عمري",artistId:"artist-2",downloadDate:new Date("2024-01-14"),fileSize:3.8,quality:"256kbps",status:"completed"},{id:"song-3",title:"نسيني الدنيا",artistId:"artist-3",downloadDate:new Date("2024-01-13"),fileSize:5.1,quality:"320kbps",status:"downloading",progress:75}];function he(){const{user:r}=E(),{toast:u}=J(),[c,$]=N.useState(""),[k,A]=N.useState("recent"),[j,D]=N.useState("grid"),{data:p}=V({queryKey:["/api/artists"]}),o=s=>{if(!p||!Array.isArray(p))return"فنان غير معروف";const t=p.find(i=>i.id===s);return(t==null?void 0:t.name)||"فنان غير معروف"},m=s=>`${s.toFixed(1)} MB`,C=s=>s.toLocaleDateString("ar-EG",{year:"numeric",month:"long",day:"numeric"}),z=L().length>0?L():_,I=z.filter(s=>c?s.title.toLowerCase().includes(c.toLowerCase())||o(s.artistId).toLowerCase().includes(c.toLowerCase()):!0).sort((s,t)=>{switch(k){case"recent":return t.downloadDate.getTime()-s.downloadDate.getTime();case"alphabetical":return s.title.localeCompare(t.title,"ar");case"size":return t.fileSize-s.fileSize;default:return 0}}),n=I.filter(s=>s.status==="completed"),x=I.filter(s=>s.status==="downloading"),O=z.filter(s=>s.status==="completed").reduce((s,t)=>s+t.fileSize,0),T=s=>{const i=JSON.parse(localStorage.getItem("downloadedSongs")||"[]").filter(g=>g.id!==s);localStorage.setItem("downloadedSongs",JSON.stringify(i)),u({title:"تم حذف التحميل",description:"تم حذف الأغنية من التحميلات المحفوظة"}),window.location.reload()},f=s=>{const i=JSON.parse(localStorage.getItem("downloadedSongs")||"[]").find(g=>g.id===s);i&&i.localAudioUrl?u({title:"تشغيل الأغنية",description:"جاري تشغيل الأغنية من التحميلات المحفوظة"}):u({title:"خطأ",description:"ملف الصوت غير متوفر محلياً",variant:"destructive"})};return r?e.jsx("div",{className:"min-h-screen bg-background text-foreground",children:e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-6xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold mb-2 bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent",children:"التحميلات"}),e.jsx("p",{className:"text-muted-foreground",children:"أغانيك المحملة للاستماع بدون إنترنت"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx(l,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center",children:e.jsx(w,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:n.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"أغنية محملة"})]})]})})}),e.jsx(l,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-green-500/10 rounded-lg flex items-center justify-center",children:e.jsx(Z,{className:"w-6 h-6 text-green-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:m(O)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"المساحة المستخدمة"})]})]})})}),e.jsx(l,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-500/10 rounded-lg flex items-center justify-center",children:e.jsx(h,{className:"w-6 h-6 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:x.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"جاري التحميل"})]})]})})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-8",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(W,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(H,{placeholder:"ابحث في التحميلات...",value:c,onChange:s=>$(s.target.value),className:"pl-10","data-testid":"input-search-downloads"})]}),e.jsxs(P,{value:k,onValueChange:A,children:[e.jsx(Q,{className:"w-48","data-testid":"select-sort-downloads",children:e.jsx(F,{placeholder:"ترتيب حسب"})}),e.jsxs(K,{children:[e.jsx(y,{value:"recent",children:"الأحدث"}),e.jsx(y,{value:"alphabetical",children:"أبجدياً"}),e.jsx(y,{value:"size",children:"حسب الحجم"})]})]}),e.jsxs("div",{className:"flex border rounded-lg overflow-hidden",children:[e.jsx(a,{variant:j==="grid"?"default":"ghost",size:"sm",onClick:()=>D("grid"),"data-testid":"button-grid-view",children:e.jsx(Y,{className:"w-4 h-4"})}),e.jsx(a,{variant:j==="list"?"default":"ghost",size:"sm",onClick:()=>D("list"),"data-testid":"button-list-view",children:e.jsx(G,{className:"w-4 h-4"})})]})]}),e.jsxs(R,{defaultValue:"completed",className:"w-full",children:[e.jsxs(U,{className:"grid w-full max-w-md mx-auto grid-cols-2 mb-8",children:[e.jsxs(M,{value:"completed","data-testid":"tab-completed",children:["مكتملة (",n.length,")"]}),e.jsxs(M,{value:"downloading","data-testid":"tab-downloading",children:["جاري التحميل (",x.length,")"]})]}),e.jsx(q,{value:"completed",children:n.length>0?j==="grid"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:n.map(s=>e.jsx(l,{className:"group hover:bg-card/80 transition-colors","data-testid":`card-download-${s.id}`,children:e.jsxs(d,{className:"p-4",children:[e.jsxs("div",{className:"aspect-square bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg mb-4 flex items-center justify-center relative",children:[e.jsx(w,{className:"w-12 h-12 text-white"}),e.jsx("div",{className:"absolute inset-0 bg-black/20 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:e.jsx(a,{size:"sm",className:"rounded-full w-12 h-12 p-0",onClick:()=>f(s.id),children:e.jsx(v,{className:"w-5 h-5"})})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-semibold truncate",children:s.title}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:o(s.artistId)}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:m(s.fileSize)}),e.jsx(b,{variant:"secondary",children:s.quality})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["تم التحميل في ",C(s.downloadDate)]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsxs(a,{size:"sm",className:"flex-1",onClick:()=>f(s.id),"data-testid":`button-play-${s.id}`,children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),"تشغيل"]}),e.jsx(a,{size:"sm",variant:"outline",onClick:()=>T(s.id),"data-testid":`button-delete-${s.id}`,children:e.jsx(S,{className:"w-4 h-4"})})]})]})]})},s.id))}):e.jsx("div",{className:"space-y-2",children:n.map(s=>e.jsx(l,{className:"group hover:bg-card/80 transition-colors","data-testid":`list-download-${s.id}`,children:e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg flex items-center justify-center",children:e.jsx(w,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold truncate",children:s.title}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:o(s.artistId)})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsx("span",{children:m(s.fileSize)}),e.jsx(b,{variant:"secondary",children:s.quality}),e.jsx("span",{children:C(s.downloadDate)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(a,{size:"sm",onClick:()=>f(s.id),children:e.jsx(v,{className:"w-4 h-4"})}),e.jsx(a,{size:"sm",variant:"outline",onClick:()=>T(s.id),children:e.jsx(S,{className:"w-4 h-4"})})]})]})})},s.id))}):e.jsxs(l,{className:"p-8 text-center",children:[e.jsx(h,{className:"w-16 h-16 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"لا توجد تحميلات"}),e.jsx("p",{className:"text-muted-foreground",children:"ابدأ بتحميل أغانيك المفضلة للاستماع بدون إنترنت"})]})}),e.jsx(q,{value:"downloading",children:x.length>0?e.jsx("div",{className:"space-y-4",children:x.map(s=>e.jsx(l,{"data-testid":`card-downloading-${s.id}`,children:e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg flex items-center justify-center",children:e.jsx(h,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold truncate",children:s.title}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:o(s.artistId)}),s.progress&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{children:"جاري التحميل..."}),e.jsxs("span",{children:[s.progress,"%"]})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:e.jsx("div",{className:"bg-primary h-2 rounded-full transition-all duration-300",style:{width:`${s.progress}%`}})})]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsx("span",{children:m(s.fileSize)}),e.jsx(b,{variant:"secondary",children:s.quality})]}),e.jsx(a,{size:"sm",variant:"outline",children:e.jsx(S,{className:"w-4 h-4"})})]})})},s.id))}):e.jsxs(l,{className:"p-8 text-center",children:[e.jsx(X,{className:"w-16 h-16 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"لا توجد تحميلات جارية"}),e.jsx("p",{className:"text-muted-foreground",children:"جميع التحميلات مكتملة"})]})})]})]})}):e.jsx("div",{className:"min-h-screen bg-background text-foreground flex items-center justify-center",children:e.jsxs(l,{className:"p-8 text-center max-w-md",children:[e.jsx(h,{className:"w-16 h-16 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"تسجيل الدخول مطلوب"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"يجب تسجيل الدخول للوصول إلى التحميلات المحفوظة"}),e.jsx(a,{onClick:()=>window.location.href="/api/login",children:"تسجيل الدخول"})]})})}export{he as default};
