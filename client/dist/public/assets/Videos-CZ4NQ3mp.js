import{r as h,d as u,j as e,B as p,P as y,X as $}from"./index-CQ1CQ49d.js";import{S as n}from"./skeleton-CIS5eNOV.js";import{C as f,c as k}from"./card-DpWYKoFa.js";import{D as C,a as A,b as D,c as S}from"./dialog-g6WB_omj.js";import{E as g}from"./eye-1SJRzZGm.js";import{V as M}from"./video-DTwUMtTX.js";import"./index-DVzphYQM.js";import"./index-C5XG4sJr.js";function q(){const[s,j]=h.useState(null),[b,o]=h.useState(!1),{data:r,isLoading:N}=u({queryKey:["/api/videos"]}),{data:c}=u({queryKey:["/api/artists"]}),d=t=>{if(!c||!Array.isArray(c))return"فنان غير معروف";const a=c.find(i=>i.id===t);return(a==null?void 0:a.name)||"فنان غير معروف"},w=t=>{const a=Math.floor(t/60),i=t%60;return`${a}:${i.toString().padStart(2,"0")}`},m=t=>t>=1e6?`${(t/1e6).toFixed(1)}M مشاهدة`:t>=1e3?`${(t/1e3).toFixed(1)}K مشاهدة`:`${t} مشاهدة`,x=t=>{const a=new Date,i=new Date(t),l=Math.floor((a.getTime()-i.getTime())/(1e3*60*60*24));return l===0?"اليوم":l===1?"أمس":l<7?`منذ ${l} أيام`:l<30?`منذ ${Math.floor(l/7)} أسابيع`:`منذ ${Math.floor(l/30)} شهر`},v=t=>{const a=r==null?void 0:r.find(i=>i.id===t);a&&(j(a),o(!0))};return N?e.jsx("div",{className:"min-h-screen bg-background text-foreground",children:e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-6xl",children:[e.jsx("h1",{className:"text-4xl font-bold mb-8 bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent",children:"الفيديوهات الموسيقية"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((t,a)=>e.jsxs("div",{className:"space-y-3",children:[e.jsx(n,{className:"w-full aspect-video rounded-xl"}),e.jsx(n,{className:"h-4 w-3/4"}),e.jsx(n,{className:"h-3 w-1/2"}),e.jsx(n,{className:"h-3 w-1/3"})]},a))})]})}):e.jsx("div",{className:"min-h-screen bg-background text-foreground",children:e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-6xl",children:[e.jsx("h1",{className:"text-4xl font-bold mb-8 bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent",children:"الفيديوهات الموسيقية"}),r&&Array.isArray(r)&&r.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(t=>e.jsx(f,{className:"group cursor-pointer hover:bg-card/80 transition-colors",onClick:()=>v(t.id),"data-testid":`card-video-${t.id}`,children:e.jsxs(k,{className:"p-0",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:t.thumbnailUrl||"https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&h=400",alt:`${t.title} Thumbnail`,className:"w-full aspect-video object-cover rounded-t-xl"}),e.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-all duration-300 rounded-t-xl flex items-center justify-center",children:e.jsx(p,{className:"w-16 h-16 bg-red-600 rounded-full flex items-center justify-center transform scale-0 group-hover:scale-100 transition-transform duration-300","data-testid":`button-play-video-${t.id}`,children:e.jsx(y,{className:"w-6 h-6 text-white ml-1"})})}),t.duration&&e.jsx("div",{className:"absolute bottom-3 right-3 bg-black/70 text-white px-2 py-1 rounded text-xs",children:w(t.duration)})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold mb-1 truncate","data-testid":`text-video-title-${t.id}`,children:t.title}),e.jsx("p",{className:"text-sm text-muted-foreground truncate mb-2","data-testid":`text-video-artist-${t.id}`,children:d(t.artistId||"")}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(g,{className:"w-3 h-3"}),e.jsx("span",{"data-testid":`text-view-count-${t.id}`,children:m(t.viewCount||0)})]}),e.jsx("span",{"data-testid":`text-video-date-${t.id}`,children:x(typeof t.createdAt=="string"?t.createdAt:new Date().toISOString())})]})]})]})},t.id))}):e.jsxs(f,{className:"p-8 text-center",children:[e.jsx(M,{className:"w-16 h-16 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"لا توجد فيديوهات"}),e.jsx("p",{className:"text-muted-foreground",children:"لا توجد فيديوهات متاحة حالياً"})]}),e.jsx(C,{open:b,onOpenChange:o,children:e.jsxs(A,{className:"max-w-4xl max-h-[80vh] p-0 bg-black border-0",children:[e.jsx(D,{className:"p-4 bg-black text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(S,{className:"text-white",children:s==null?void 0:s.title}),e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>o(!1),className:"text-white hover:bg-white/20",children:e.jsx($,{className:"w-4 h-4"})})]})}),e.jsx("div",{className:"aspect-video bg-black",children:s&&e.jsxs("video",{controls:!0,autoPlay:!0,className:"w-full h-full",poster:s.thumbnailUrl||void 0,children:[e.jsx("source",{src:s.videoUrl,type:"video/mp4"}),"متصفحك لا يدعم تشغيل الفيديو"]})}),s&&e.jsxs("div",{className:"p-4 bg-card text-foreground",children:[e.jsx("h3",{className:"font-semibold mb-2",children:s.title}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:d(s.artistId||"")}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(g,{className:"w-4 h-4"}),e.jsx("span",{children:m(s.viewCount||0)})]}),e.jsx("span",{children:x(typeof s.createdAt=="string"?s.createdAt:new Date().toISOString())})]})]})]})})]})})}export{q as default};
