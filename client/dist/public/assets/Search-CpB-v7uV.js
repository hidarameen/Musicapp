import{u as K,r as c,d as I,j as e,M as j,B as f,H as $,P as B}from"./index-BEosjvFY.js";import{I as D}from"./input-_8EU6oC7.js";import{B as F}from"./badge-D52QBSsT.js";import{C as h,c as u}from"./card-DjIf65r2.js";import{S as N}from"./skeleton-BGX3xLQu.js";import{T as H,a as R,b,c as v}from"./tabs-B7vLysKc.js";import{S as G,a as J,b as O,c as W,d as w}from"./select-D9-QZINv.js";import{S as M,C as y}from"./search-DeohbOdD.js";import{U as S}from"./users-CyOdMYj1.js";import{V as C}from"./video-B9ELjgIP.js";import"./index-Cut7O9C5.js";import"./index-CXlEOQ-e.js";import"./index-Ctp2OgOU.js";import"./check-BsigYy_i.js";function me(){const[U]=K(),[r,k]=c.useState(""),[a,A]=c.useState(""),[V,q]=c.useState("all"),[P,Q]=c.useState("relevance");c.useEffect(()=>{const t=new URLSearchParams(U.split("?")[1]||"").get("q");t&&(k(t),A(t))},[U]),c.useEffect(()=>{const s=setTimeout(()=>{A(r)},300);return()=>clearTimeout(s)},[r]);const l=a.length>=2,{data:L,isLoading:z}=I({queryKey:["/api/songs"],enabled:l,staleTime:5*60*1e3}),{data:n,isLoading:E}=I({queryKey:["/api/artists"],enabled:l,staleTime:5*60*1e3}),{data:T,isLoading:_}=I({queryKey:["/api/videos"],enabled:l,staleTime:5*60*1e3}),d=c.useMemo(()=>!l||!a||!L?[]:L.filter(s=>{var t,i;return((t=s.title)==null?void 0:t.toLowerCase().includes(a.toLowerCase()))||((i=x(s.artistId||""))==null?void 0:i.toLowerCase().includes(a.toLowerCase()))}).slice(0,50),[l,a,L,n]),o=c.useMemo(()=>!l||!a||!n?[]:n.filter(s=>{var t;return(t=s.name)==null?void 0:t.toLowerCase().includes(a.toLowerCase())}).slice(0,20),[l,a,n]),m=c.useMemo(()=>!l||!a||!T?[]:T.filter(s=>{var t,i;return((t=s.title)==null?void 0:t.toLowerCase().includes(a.toLowerCase()))||((i=x(s.artistId||""))==null?void 0:i.toLowerCase().includes(a.toLowerCase()))}).slice(0,30),[l,a,T,n]),x=s=>{if(!n||!Array.isArray(n))return"فنان غير معروف";const t=n.find(i=>i.id===s);return(t==null?void 0:t.name)||"فنان غير معروف"},p=s=>{const t=Math.floor(s/60),i=s%60;return`${t}:${i.toString().padStart(2,"0")}`},g=z||E||_;return e.jsx("div",{className:"min-h-screen bg-background text-foreground",children:e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-6xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold mb-6 bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent",children:"البحث في الموسيقى"}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx(M,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-5 h-5"}),e.jsx(D,{type:"text",placeholder:"ابحث عن الأغاني، الفنانين، أو الفيديوهات...",value:r,onChange:s=>k(s.target.value),className:"pl-12 pr-4 py-3 text-lg bg-card border-border focus:border-primary","data-testid":"input-search"})]}),r&&e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs("p",{className:"text-muted-foreground",children:["نتائج البحث عن: ",e.jsxs("span",{className:"text-foreground font-semibold",children:['"',r,'"']})]}),e.jsxs(F,{variant:"secondary",children:[d.length+o.length+m.length," نتيجة"]})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs(G,{value:P,onValueChange:Q,children:[e.jsx(J,{className:"w-48","data-testid":"select-sort",children:e.jsx(O,{placeholder:"ترتيب حسب"})}),e.jsxs(W,{children:[e.jsx(w,{value:"relevance",children:"الأكثر صلة"}),e.jsx(w,{value:"recent",children:"الأحدث"}),e.jsx(w,{value:"popular",children:"الأكثر شيوعاً"}),e.jsx(w,{value:"alphabetical",children:"أبجدياً"})]})]})})]}),e.jsxs(H,{value:V,onValueChange:q,className:"w-full",children:[e.jsxs(R,{className:"grid w-full max-w-md mx-auto grid-cols-4 mb-8",children:[e.jsxs(b,{value:"all","data-testid":"tab-all",children:["الكل (",d.length+o.length+m.length,")"]}),e.jsxs(b,{value:"songs","data-testid":"tab-songs",children:["أغاني (",d.length,")"]}),e.jsxs(b,{value:"artists","data-testid":"tab-artists",children:["فنانين (",o.length,")"]}),e.jsxs(b,{value:"videos","data-testid":"tab-videos",children:["فيديو (",m.length,")"]})]}),e.jsx(v,{value:"all",className:"space-y-8",children:g?e.jsx("div",{className:"space-y-4",children:[...Array(6)].map((s,t)=>e.jsx(N,{className:"h-20 w-full"},t))}):e.jsxs(e.Fragment,{children:[o.length>0&&e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold mb-4 flex items-center gap-2",children:[e.jsx(S,{className:"w-6 h-6"}),"الفنانين"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:o.slice(0,6).map(s=>e.jsx(h,{className:"group hover:bg-card/80 transition-colors cursor-pointer","data-testid":`card-artist-${s.id}`,children:e.jsxs(u,{className:"p-4 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-3 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center overflow-hidden",children:s.profileImageUrl?e.jsx("img",{src:s.profileImageUrl,alt:s.name,className:"w-full h-full object-cover"}):e.jsx(S,{className:"w-8 h-8 text-white"})}),e.jsx("h3",{className:"font-semibold text-sm mb-1 truncate",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"فنان"})]})},s.id))})]}),d.length>0&&e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold mb-4 flex items-center gap-2",children:[e.jsx(j,{className:"w-6 h-6"}),"الأغاني"]}),e.jsx("div",{className:"space-y-2",children:d.slice(0,10).map((s,t)=>e.jsx(h,{className:"group hover:bg-card/80 transition-colors cursor-pointer","data-testid":`card-song-${s.id}`,children:e.jsx(u,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-muted-foreground text-sm w-6",children:t+1}),e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg flex items-center justify-center",children:e.jsx(j,{className:"w-6 h-6 text-white"})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold truncate",children:s.title}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:x(s.artistId||"")})]}),s.duration&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(y,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:p(s.duration)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{size:"sm",variant:"ghost",className:"opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx($,{className:"w-4 h-4"})}),e.jsx(f,{size:"sm",className:"opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(B,{className:"w-4 h-4"})})]})]})})},s.id))})]}),m.length>0&&e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold mb-4 flex items-center gap-2",children:[e.jsx(C,{className:"w-6 h-6"}),"الفيديوهات"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:m.slice(0,6).map(s=>e.jsx(h,{className:"group hover:bg-card/80 transition-colors cursor-pointer","data-testid":`card-video-${s.id}`,children:e.jsxs(u,{className:"p-0",children:[e.jsx("div",{className:"aspect-video bg-gradient-to-br from-purple-500 to-pink-500 rounded-t-lg flex items-center justify-center",children:s.thumbnailUrl?e.jsx("img",{src:s.thumbnailUrl,alt:s.title,className:"w-full h-full object-cover rounded-t-lg"}):e.jsx(C,{className:"w-12 h-12 text-white"})}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold mb-1 truncate",children:s.title}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:x(s.artistId||"")}),s.duration&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-xs",children:[e.jsx(y,{className:"w-3 h-3"}),e.jsx("span",{children:p(s.duration)})]})]})]})},s.id))})]}),r&&d.length===0&&o.length===0&&m.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(M,{className:"w-16 h-16 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"لم نجد أي نتائج"}),e.jsx("p",{className:"text-muted-foreground",children:"جرب البحث بكلمات مختلفة أو تصفح المحتوى المتاح"})]})]})}),e.jsx(v,{value:"songs",children:e.jsx("div",{className:"space-y-2",children:g?[...Array(8)].map((s,t)=>e.jsx(N,{className:"h-16 w-full"},t)):d.length>0?d.map((s,t)=>e.jsx(h,{className:"group hover:bg-card/80 transition-colors cursor-pointer","data-testid":`song-item-${s.id}`,children:e.jsx(u,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-muted-foreground text-sm w-6",children:t+1}),e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg flex items-center justify-center",children:e.jsx(j,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold truncate",children:s.title}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:x(s.artistId||"")})]}),s.duration&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(y,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:p(s.duration)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{size:"sm",variant:"ghost",className:"opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx($,{className:"w-4 h-4"})}),e.jsx(f,{size:"sm",className:"opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(B,{className:"w-4 h-4"})})]})]})})},s.id)):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(j,{className:"w-16 h-16 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"لا توجد أغاني"}),e.jsx("p",{className:"text-muted-foreground",children:r?"لم نجد أغاني تطابق بحثك":"لا توجد أغاني متاحة حالياً"})]})})}),e.jsx(v,{value:"artists",children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:g?[...Array(12)].map((s,t)=>e.jsx(N,{className:"h-32 w-full"},t)):o.length>0?o.map(s=>e.jsx(h,{className:"group hover:bg-card/80 transition-colors cursor-pointer","data-testid":`artist-item-${s.id}`,children:e.jsxs(u,{className:"p-4 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-3 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center overflow-hidden",children:s.profileImageUrl?e.jsx("img",{src:s.profileImageUrl,alt:s.name,className:"w-full h-full object-cover"}):e.jsx(S,{className:"w-8 h-8 text-white"})}),e.jsx("h3",{className:"font-semibold text-sm mb-1 truncate",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"فنان"})]})},s.id)):e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx(S,{className:"w-16 h-16 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"لا يوجد فنانين"}),e.jsx("p",{className:"text-muted-foreground",children:r?"لم نجد فنانين يطابقون بحثك":"لا يوجد فنانين متاحين حالياً"})]})})}),e.jsx(v,{value:"videos",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:g?[...Array(9)].map((s,t)=>e.jsx(N,{className:"h-48 w-full"},t)):m.length>0?m.map(s=>e.jsx(h,{className:"group hover:bg-card/80 transition-colors cursor-pointer","data-testid":`video-item-${s.id}`,children:e.jsxs(u,{className:"p-0",children:[e.jsx("div",{className:"aspect-video bg-gradient-to-br from-purple-500 to-pink-500 rounded-t-lg flex items-center justify-center",children:s.thumbnailUrl?e.jsx("img",{src:s.thumbnailUrl,alt:s.title,className:"w-full h-full object-cover rounded-t-lg"}):e.jsx(C,{className:"w-12 h-12 text-white"})}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold mb-1 truncate",children:s.title}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:x(s.artistId||"")}),s.duration&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-xs",children:[e.jsx(y,{className:"w-3 h-3"}),e.jsx("span",{children:p(s.duration)})]})]})]})},s.id)):e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx(C,{className:"w-16 h-16 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"لا توجد فيديوهات"}),e.jsx("p",{className:"text-muted-foreground",children:r?"لم نجد فيديوهات تطابق بحثك":"لا توجد فيديوهات متاحة حالياً"})]})})})]})]})})}export{me as default};
